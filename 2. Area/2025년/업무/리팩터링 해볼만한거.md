

```cs
 private string GetAllMessages(Exception ex, string separator = "\r\nInnerException: ")
 {
     var m_Message = new StringBuilder();

     if (ex != null)
     {
         if (ex.Message.Length >= 1000)
             m_Message.Append(ex.Message.Substring(0, 1000));
         else
             m_Message.Append(ex.Message);
     }

     if (ex.InnerException != null)
     {
         m_Message.Append(separator);

         if (ex.InnerException.Message.Length >= 1000)
             m_Message.Append(ex.InnerException.Message.Substring(0, 1000));
         else
             m_Message.Append(ex.InnerException.Message);
     }

     if (m_Message.Length >= 1000)
     {
         m_Message.Remove(1000, m_Message.Length - 1000);
         return m_Message.ToString();
     }
     else
     {
         return m_Message.ToString();
     }
 }
```


```cs
var systemDescription = string.IsNullOrEmpty(description)
    ? String.Empty
    : (description + Environment.NewLine);

systemDescription += (exception != null ? GetAllMessages(exception) : string.Empty);
systemDescription += (exception != null && !string.IsNullOrEmpty(exception.StackTrace)
    ? (Environment.NewLine + exception.StackTrace)
    : string.Empty);
```