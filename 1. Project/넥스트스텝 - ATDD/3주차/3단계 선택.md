
**학습 목표**
 - 시스템 레벨 인수 테스트를 AI로 생성, 운영
	 - 대상 프로젝트 : `reservation`, `admin`, `kiosk`, `payments (WireMock)`
 - 정상/경계/예외 시나리오를 포괄하는 Gherkin 기반 시나리오를 작성한다

**배경 및 범위**
- 기반 환경 
	- `kiosk > reservation > admin`
	- `kiosk > payments(WireMock)` 연결
- 기능 신규 개발이 아니라, 시나리오 기반의 인수 테스트 포트폴리오 구축이 목표

> kiosk에서 reservation으로 요청하는 api는 없다
> - `kiosk -> admin`와 `kisok -> payments` 요청만 존재한다
> // reservation이 들어가는 형태로 하면 좋지 않을가 싶네 (개인 의견)
- AdminAuthClient, AdminClient, PaymentClient가 존재한다
- ProductController에서는 상품 목록 조회 api 1개만 존재한다
	- `/admin/products`
- PaymentController에서는 `결제 생성, 승인`에 대한 api 2개가 존재한다
	- 결제 생성 : PaymentClient 통해 생성
	- 결제 승인 : 성공시 AdminClient 통해 `/api/sales`를 호출한다
		- payments의 경우 wiremock으로 대체
		- 세부적으로 알 필요 없이 response dto (inner class)만 알면 stub하기 쉽다

> reservation -> admin도 없다
> 1주차 과제였는데 h2 db에 저장하는 걸로 끝이였던거 같다
- 예약 생성, 조회, 수정, 취소 등등
- 사이트 목록/상세 조회, 사이트 검색(날짜/기간별)

> admin의 경우 전체 API가 아닌 사용 예상 되는 API 대상으로만 작성하도록 한다

>[!note] kiosk > reservation > admin에 대한 api 가 명확히 없다. 고로 기능 구현이 목적이 아닌 인수 테스트 가이드 문서 구축을 목적으로 접근을 해야 할듯하다

>[!info] "기능 신규 개발이 아니라, 시나리오 기반의 인수 테스트 포트폴리오 구축이 목표." 의미에 대해
>선택 과제 요구사항을 보면 **"AI로 생성·운영한다"**는 문구가 핵심입니다. 이는 "지금 코드가 돌아가느냐"보다 **"나중에 기능을 개발했을 때, AI가 즉시 이 테스트를 만들어낼 수 있도록 '설계 도면(Context)'을 얼마나 잘 닦아놓았는가"**를 평가하겠다는 뜻입니다.


**해야 하는 것**
- [ ] 테스트 작성 가이드 문서화 : `atdd-tests/docs/acceptance-test-guide.md`
- [ ] 인증/실행 가이드 문서화 : `atdd-tests/docs/auth-setup.md`
- [ ] `@ai-candidate` 태그 등 태그를 활용하여 AI 생성 인수 테스트 추가


### 요구사항 
**1) AI 입력 컨텍스트 표준화**
- 포함 : 시스템 개요, 엔드포인트 요약, 사용자 여정, 인증/시드 데이터 규칙, 좋은/나쁜 예시, 품질 기준 등
- 이떄 AI 도구를 활용하여 문서 작성 추천 

**2) 검토 게이트**
..


**3) 태깅/실행 규칙**

...

---

### memo
프로젝트 rest api 재분석 정리 
- **kiosk**
- **reservation**
- **admin**
- **payments(WireMock으로 대체)**
	- WireMock url을 "기타"로 기재 하는것도 좋을듯하다

아스키아트 
- https://monodraw.helftone.com/
- https://asciiflow.com/#/

> mermaid로 대체 가능 

> reference가 없구나 
- https://cucumber.io/docs
- https://wiremock.org/docs/


현재 상태에서 cucumber의 태그 기능을 활용하지 않고 있다. 
wiremock stub 방식을 사용할 때 tip도 있으면 좋지 않을까?
- json과 코드레벨 방식의 장단점 .. (가이드 문서에는 없어도 괜찮을 듯하다)

docker `.env`를 활용하는 방식을 내가 안썼네 
- `.gitignore`에 설정도 필요할 듯 하다.

---

```text
내가 여태까지 질문한 컨텍스트에 대해 기억하고 있나요? kiosk, admin,
reservation, payments(WireMock) 서비스 연계에 대한 인수 테스트 가이드 문서를
작성하려고 합니다. AI와 협업하기 위한 컨텍스트를 만들려고 하고, 이에 앞서
질문을 드려요. 어떤 정보를 줘야 테스트 작성 가이드 문서와 인증/실행 가이드
문서를 잘 작성할 수 있을까요?
```


```text
✦ 네, 이전에 나눈 대화와 현재 컨텍스트를 기억하고 있습니다. kiosk, admin,
  reservation, payments (WireMock) 서비스 연계를 위한 인수 테스트 가이드 문서를
  작성하는 데 필요한 정보를 제공해주시면 제가 더 정확하고 유용한 가이드를 작성할
  수 있습니다.

  테스트 작성 가이드 문서와 인증/실행 가이드 문서를 효과적으로 작성하기 위해
  다음 정보들이 필요합니다.


   1. 프로젝트 및 서비스 개요:
       * 각 서비스(kiosk, admin, reservation, payments)의 주요 역할과 비즈니스
         목적을 간략하게 설명해주세요.
       * 각 서비스가 서로 어떻게 연동되는지, 데이터 흐름은 어떻게 되는지
         고수준에서 설명해주시면 좋습니다. (예: kiosk -> reservation -> payments
         순으로 호출)
       * 각 서비스에서 사용되는 주요 기술 스택(예: Spring Boot, Node.js 등)을
         알려주세요.


   2. 인수 테스트 관련 상세 정보:
       * 현재 인수 테스트는 어떤 시나리오를 중점적으로 다루고 있나요? (예: 제품
         조회 및 예약, 예약 확인, 결제 연동 등)
       * 각 서비스 연동 과정에서 성공 및 실패 시나리오에 대한 기대 결과는
         무엇인가요?
       * payments 서비스의 WireMock은 어떤 결제 시나리오를 모킹하고 있으며, 어떤
         응답을 반환하도록 설정되어 있는지 알려주세요.
         (infra/wiremock/mappings/payment-health.json 외에 다른 매핑 파일도
         있다면 알려주세요.)


   3. 인증/권한 부여 관련 정보:
       * kiosk, admin, reservation 서비스 간 또는 외부 클라이언트와의 인증
         방식은 무엇인가요? (예: JWT, OAuth2, API Key, 세션 등)
       * 테스트를 실행하기 위해 필요한 인증 토큰 또는 자격 증명을 어떻게 획득할
         수 있나요? (예: 특정 API 호출, 개발자용 토큰 등)
       * 각 서비스별로 다른 사용자 역할(Role)이나 권한(Permission)이 있다면
         설명해주세요.


   4. 실행 환경 및 구성:
       * 테스트 환경(개발 환경 또는 CI/CD 환경)에서 서비스들은 어떻게 배포되고
         실행되나요? (Docker Compose를 사용하는 것으로 보이는데, 이에 대한
         자세한 설명이 필요합니다.)
       * 테스트 실행을 위한 전제 조건(예: 특정 JDK 버전, Gradle 설치, Docker
         설치 등)은 무엇인가요?
       * 테스트 실행 시 필요한 환경 변수나 config.properties 파일 외에 추가적인
         설정이 있다면 알려주세요.
       * 로컬에서 서비스를 시작하고 중지하는 일반적인 절차를 알려주세요.


  이 정보들을 바탕으로 제가 인수 테스트 가이드 문서를 구조화하고 내용을
  채워나가겠습니다.
```


Q.
```text
우선 requirements.md와 docs/api에 있는 api 명세를 읽어주세요
```


```
# 인수 테스트 작성 가이드

## 1. 시스템 개요
- 아래 흐름에 대한 도식화 표현 원함 
- **kiosk → reservation → admin**, **kiosk → payments(WireMock)** 연결


## 2. Endpoint 요약

### 2-1. Kiosk

### 2-2. Reservation

### 2-3. Admin

### 2-4. Payments (WireMock)

- 참고. WireMock 맵핑, 확인 주소 포함

  

## 3. 사용자 여정 
- Happy Path, Sad Path

## 4. 인증 규칙
- JWT Bearer Token

## 5. 시드 데이터 규칙

## 6. 시나리오 예시 
### 6-1. 좋은 시나리오
### 6-2. 나쁜 시나리오

## 7. 품질 기준 체크 리스트

## 8. 프로젝트 폴더 구조

## 9. 터미널 실행 명령어
- 로그 디버깅 방법 (정보 제공 예정)

## 10. WireMock 설정


```



