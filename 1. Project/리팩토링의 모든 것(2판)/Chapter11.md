
### 스터디 기록

미묘한 결정이 필요할때 시니어가 진지하게 좋게 생각하는지 논리를 잘 설명하고, 미래의 변경 가능성 보고 설명해주는게 좋은데 보통.. 강압적으로 하는 케이스가 많다.

논리적으로 말해도 모욕감을 느끼는 경우도 있다 // 시니어, 주니어

코드 리뷰를 할 때 사람을 주어로 쓰지 말라 ! // 메타, 인신 공격

사람을 빼고 코드, 상황을 


📚 **함께 자라기** (필독서)
https://product.kyobobook.co.kr/detail/S000001033071

👨‍🏫 김창준 - [과학적인 정보 수집법 (클래스101)](https://class101.net/ko/products/5e26f76b990d556b7c122241)
- 사람에 대한 정보를 얻고 싶을때 , 직관은 미신이 많으니 잘하는 방법을 가르쳐주는 강의도 있다
- 껍데기 정보, 착각들, 오해를 얻기 쉽다 >> 과학적인 정보 수집법

**CQS != CQRS**
CQS  // 메서드, 함수 레벨
- 부수효과에 관련된거다 
- 조회 함수를 실행할 때 오브젝트 상태를 변경하지 말자
- 오브젝트 상태를 변경하는 메서드를 호출할 때는 조회 함수를 호출하지 말자
- 핵심은 조회다 ! 
- 업데이트나 변경할 때 메서드 체이닝 방식으로 간편하게 리턴하기도 한다
- 조회하는데 오브젝트 상태가 바꼈다 ?! toString()에 상태 변경을 넣은 라이브러리가 있었음
- 스택 구현에 pop()도 있었는데, CQS 위반이었다 
 - 조회하고 일단 꺼내라 ? 마틴 파울러는 pop()같은 함수는 CQS 위반이라해서 조회한다고 해서 문제일으킬거 같지 않다 // peek() 조회가 있다
 - pop()이 CQS 위반하지만 대표적으로 허용
 - 참고. [링크드인-토비](https://www.linkedin.com/posts/tobyilee_%EC%83%9D%EC%84%B1%EC%9E%90%EB%82%98-%EC%A0%95%EC%A0%81-%ED%8C%A9%ED%86%A0%EB%A6%AC-%EB%A9%94%EC%86%8C%EB%93%9C%EB%8A%94-cqs%EB%A5%BC-%EC%9C%84%EB%B0%98%ED%95%9C-%EA%B2%83%EC%9D%B8%EA%B0%80-%EC%83%9D%EC%84%B1%EC%9E%90-%ED%98%B8%EC%B6%9C%EC%9D%80-%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%98-activity-7313472035819552768-5hjX?utm_source=share&utm_medium=member_desktop&rcm=ACoAAECs2Y0BE1WyFjND4CvQJaQIJ13P2C-SSX4)
  
CQRS // 어플리케이션 아키텍처 레벨에서 확장
- 그렉영이 CQRS 처음 만듦 , 이건 디자인 패턴인데 읽기와 변경 오브젝트 레벨에서 구분하자를 제안하는 아키텍처 패턴이다
- 근데, CQRS 하는 사람은 이벤트 소싱(ex. 깃)을 하자거나 
- 읽기 모델과 쓰기 모델을 분리하자 // DB 나 모델 분리까지 고려하기도(replication)
- 단순한 패턴으로 제안했지만, 경우에 따라 다르게 해석이 되었구나
- 이벤트 소싱 매우 어렵다, 마틴 파울러도 CQRS로 실패한 프로젝트 많아 함부로 사용하지 말라고 얘기함  

  

간단하게 한다면 읽기, 쓰기를 분리하는걸 해볼 수 있다     
어떤 오브젝트 레벨에 CQRS할건인지 어려워진다 
서비스가 복잡해지면 분리하는게 나중에 좋을수 있다
CRUD만 한다면 하나로, 분리하면 의존하는 대상들도 달라질 수 있다
레포지토리도 읽기와 변경을 구분해서 붙일 수 있다
뭐가 좋은지 직접 경험해보면 좋다

// RDB로 실시간 적용하는 것보다 이벤트로 쏘고  ……….// 30분 이후로 강의



사이드 이펙트 == 겉보기 부수 효과  // 부작용에 부가 사이드 의미
- 조시웅이 사이드 이펙트를 헷갈리니 아웃 사이드 이펙트라 부르자고 
- 한국에서는 부작용이라 부르니 안 좋은 일이 일어난다고 생각함 
- 내가 목적했던거 외에 다른 작용이 일어나면 부작용다 // 약의 부작용
- 쉽게 말해서 함수는 부작용 없는게 좋다 ! 
- 있어도 괜찮은 부작용중 하나가 캐시 , 똑같은 걸 여러번 조회하면 저장해두고 일정 시간 동안 유지
- 이거는 CQS 위반아님, 추상 부수 효과, 구체 부수 효과 ? // 복잡하구나 

// 위고비?? 무슨 의미지 , 영어 

  

11.8 생성자를 팩터리 함수로 바꾸기 // 이펙티브 자바 참고하면 도움될 것이다

  
**예외 관련**
- 토비의 스프링 6 인프런 강의 보면 예외에 대한 설명있음 
- checked 예외가 좋지 않은 이유에 대해
	- **예외를 복구할 수 있는건가 아닌가로 구분 가능** 
	- 중복 검사가 될때 의미 있는 예외를 던져서 http 응답 코드로 바꿔서 던져주는 복구 // 근데 이거는 백엔드에서 복구 불가능
	- 예외라는 정상적인 시나리오 처리를 못할 때 던짐 
	- 대부분의 예외는 복구가 불가능하므로 캐시하면 안됨 
	- 캐시해서 할 수 있는건 로그를 던지는 것 정도 
	- 캐시만 하고 무시하면 심각한 버그를 발생 가능하다
- 복구를 할 수 있는 케이스 
	- 네트워크, 시스템이 불안하여 외부에 멀리 요청을 보내는데  // 서킷 브레이커는 빠르게 하는 거라 조금 다르고
	- 낙관적 락을 사용하는 경우 운이 나빠 동시성 문제가 발생하면 랜덤한 시간만큼 대기했다 다시 시도하면 대부분 성공함
	- 만약 최대 횟수만큼 시도 했는데 안되면 어쩔 수 없음
- 그리고 fallback 인 경우 (다른 케이스)
	- 결제 요청시 부하로 버벅거려 에러가 나는데 정상 케이스가 실패했을 때 다음 대응 방법을 만들어 두는 것
	- 카프카 쓴다면 데드레터 큐에 넣어 다시 꺼내 재시도하거나 (복구 메거니즘 중 하나)
- 외부에 전송해야 하는데 내부에 저장해두고 정상 리턴  // 이런게 복구하는거다 
- 이런 예외가 아니라면 로그를 남기고 관리자에게 알림을 보내는 형태로 .. 
	- 예외의 레벨이 높다면 담당자에게 알림하고 사용자에게 알리는거 밖에 할게 없음
	- <font color="#ff0000">모든 예외에 대해서는 복구할 수 있는가 아닌가 기준만 잘 생각하고 작업하면 좋다 </font>

**잔액이 부족한 상황일 때** 
- checked 예외로 캐치하도록 하여 의미있는 메세지 던짐
- throw 나 캐치하지 않으면 안되는 예외, 그러므로 최대한 빨리 받아서 런타임으로 감싸서 던져야 한다
- checked 예외는 정말 의미있는 경우가 아니라면 쓰지 말라 ! 라이브러리에서도 잡아서 런타임 변경
- 이런 예외가 던져 질 수 있다는 걸 checked가 알려주기도 한다
- 많은 예외는 버그 때문에 발생한다 >> 이거는 절대 잡으면 안되고 예외 발생하도록 하여 잡는게 현명
- 사용자 실수, 네트워크 에러, 상대편 시스템 문제가 발생하는 경우가 예외적인 상황이다
- 예외는 복구할수 없는 예외니깐 담당자에게 알려주고 처리하도록 하는게 낫다


널오브젝트, 함수형 스타일로 예외 던진다거나 
  
서킷 브레이커는 다른 개념.. 내부에서 바로 예외를 던져버릴 수 있음

한 두 프로세스가 돌면서 살아나는지 확인하고 도는거다 

// 이건 전체 시스템 레벨에 예외를 적용하는 방법이다 

  

  

